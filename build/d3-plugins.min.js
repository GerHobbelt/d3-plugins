!function(){function a(a){return[0,a.length-1]}function b(a){return[d3.quantile(a,.25),d3.quantile(a,.5),d3.quantile(a,.75)]}d3.box=function(){function c(a){a.each(function(a,b){a=a.map(h).sort(d3.ascending);var c=d3.select(this),l=a.length,m=a[0],n=a[l-1],o=a.quartiles=j(a),p=i&&i.call(this,a,b),q=p&&p.map(function(b){return a[b]}),r=p?d3.range(0,p[0]).concat(d3.range(p[1]+1,l)):d3.range(l),s=d3.scale.linear().domain(g&&g.call(this,a,b)||[m,n]).range([e,0]),t=this.__chart__||d3.scale.linear().domain([0,1/0]).range(s.range());this.__chart__=s;var u=c.selectAll("line.center").data(q?[q]:[]);u.enter().insert("line","rect").attr("class","center").attr("x1",d/2).attr("y1",function(a){return t(a[0])}).attr("x2",d/2).attr("y2",function(a){return t(a[1])}).style("opacity",1e-6).transition().duration(f).style("opacity",1).attr("y1",function(a){return s(a[0])}).attr("y2",function(a){return s(a[1])}),u.transition().duration(f).style("opacity",1).attr("y1",function(a){return s(a[0])}).attr("y2",function(a){return s(a[1])}),u.exit().transition().duration(f).style("opacity",1e-6).attr("y1",function(a){return s(a[0])}).attr("y2",function(a){return s(a[1])}).remove();var v=c.selectAll("rect.box").data([o]);v.enter().append("rect").attr("class","box").attr("x",0).attr("y",function(a){return t(a[2])}).attr("width",d).attr("height",function(a){return t(a[0])-t(a[2])}).transition().duration(f).attr("y",function(a){return s(a[2])}).attr("height",function(a){return s(a[0])-s(a[2])}),v.transition().duration(f).attr("y",function(a){return s(a[2])}).attr("height",function(a){return s(a[0])-s(a[2])});var w=c.selectAll("line.median").data([o[1]]);w.enter().append("line").attr("class","median").attr("x1",0).attr("y1",t).attr("x2",d).attr("y2",t).transition().duration(f).attr("y1",s).attr("y2",s),w.transition().duration(f).attr("y1",s).attr("y2",s);var x=c.selectAll("line.whisker").data(q||[]);x.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",t).attr("x2",d).attr("y2",t).style("opacity",1e-6).transition().duration(f).attr("y1",s).attr("y2",s).style("opacity",1),x.transition().duration(f).attr("y1",s).attr("y2",s).style("opacity",1),x.exit().transition().duration(f).attr("y1",s).attr("y2",s).style("opacity",1e-6).remove();var y=c.selectAll("circle.outlier").data(r,Number);y.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",d/2).attr("cy",function(b){return t(a[b])}).style("opacity",1e-6).transition().duration(f).attr("cy",function(b){return s(a[b])}).style("opacity",1),y.transition().duration(f).attr("cy",function(b){return s(a[b])}).style("opacity",1),y.exit().transition().duration(f).attr("cy",function(b){return s(a[b])}).style("opacity",1e-6).remove();var z=k||s.tickFormat(8),A=c.selectAll("text.box").data(o);A.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",function(a,b){return 1&b?6:-6}).attr("x",function(a,b){return 1&b?d:0}).attr("y",t).attr("text-anchor",function(a,b){return 1&b?"start":"end"}).text(z).transition().duration(f).attr("y",s),A.transition().duration(f).text(z).attr("y",s);var B=c.selectAll("text.whisker").data(q||[]);B.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",d).attr("y",t).text(z).style("opacity",1e-6).transition().duration(f).attr("y",s).style("opacity",1),B.transition().duration(f).text(z).attr("y",s).style("opacity",1),B.exit().transition().duration(f).attr("y",s).style("opacity",1e-6).remove()}),d3.timer.flush()}var d=1,e=1,f=0,g=null,h=Number,i=a,j=b,k=null;return c.width=function(a){return arguments.length?(d=a,c):d},c.height=function(a){return arguments.length?(e=a,c):e},c.tickFormat=function(a){return arguments.length?(k=a,c):k},c.duration=function(a){return arguments.length?(f=a,c):f},c.domain=function(a){return arguments.length?(g=null==a?a:d3.functor(a),c):g},c.value=function(a){return arguments.length?(h=a,c):h},c.whiskers=function(a){return arguments.length?(i=a,c):i},c.quartiles=function(a){return arguments.length?(j=a,c):j},c}}(),function(){function a(a){return a.ranges}function b(a){return a.markers}function c(a){return a.measures}function d(a){var b=a(0);return function(c){return Math.abs(a(c)-b)}}d3.bullet=function(){function e(a){a.each(function(a,b){var c,e,f=i.call(this,a,b).slice().sort(d3.descending),o=j.call(this,a,b).slice().sort(d3.descending),p=k.call(this,a,b).slice().sort(d3.descending),q=d3.select(this),r=q.select("g.wrap");r.empty()&&(r=q.append("g").attr("class","wrap")),h?(c=m,e=l,r.attr("transform","rotate(90)translate(0,"+-l+")")):(c=l,e=m,r.attr("transform","translate(0)"));var s=d3.scale.linear().domain([0,Math.max(f[0],o[0],p[0])]).range(g?[c,0]:[0,c]),t=this.__chart__||d3.scale.linear().domain([0,1/0]).range(s.range());this.__chart__=s;var u=d(t),v=d(s),w=r.selectAll("rect.range").data(f);w.enter().append("rect").attr("class",function(a,b){return"range s"+b}).attr("width",u).attr("height",e).attr("x",g?t:0),d3.transition(w).attr("x",g?s:0).attr("width",v).attr("height",e);var x=r.selectAll("rect.measure").data(p);x.enter().append("rect").attr("class",function(a,b){return"measure s"+b}).attr("width",u).attr("height",e/3).attr("x",g?t:0).attr("y",e/3),d3.transition(x).attr("width",v).attr("height",e/3).attr("x",g?s:0).attr("y",e/3);var y=r.selectAll("line.marker").data(o);y.enter().append("line").attr("class","marker").attr("x1",t).attr("x2",t).attr("y1",e/6).attr("y2",5*e/6),d3.transition(y).attr("x1",s).attr("x2",s).attr("y1",e/6).attr("y2",5*e/6);var z=q.selectAll("g.axis").data([0]);z.enter().append("g").attr("class","axis"),z.call(n.scale(s))}),d3.timer.flush()}var f="left",g=!1,h=!1,i=a,j=b,k=c,l=380,m=30,n=d3.svg.axis();return e.orient=function(a){return arguments.length?(f=a+"",g="right"==f||"bottom"==f,n.orient((h="top"==f||"bottom"==f)?"left":"bottom"),e):f},e.ranges=function(a){return arguments.length?(i=a,e):i},e.markers=function(a){return arguments.length?(j=a,e):j},e.measures=function(a){return arguments.length?(k=a,e):k},e.width=function(a){return arguments.length?(l=+a,e):l},e.height=function(a){return arguments.length?(m=+a,e):m},d3.rebind(e,n,"tickFormat")}}(),function(){function a(a){return a>0?1:0>a?-1:0}function b(){function b(a){a instanceof Array?a.each(c):d3.select(this).each(c)}function c(b){var c=d3.select(this),n=30*("function"==typeof d?d(b):d),o=80*("function"==typeof e?e(b):e),p=7*("function"==typeof f?f(b):f),q=10*("function"==typeof g?g(b):g),r=10*("function"==typeof h?h(b):h),s=10*("function"==typeof i?i(b):i),t=10*("function"==typeof j?j(b):j),u=3*("function"==typeof k?k(b):k),v=[{x:70,y:60},{x:120,y:80},{x:120-n,y:110},{x:120-n,y:160},{x:20+n,y:160},{x:20+n,y:110},{x:20,y:80}];c.selectAll("path.face").data([v]).enter().append("path").attr("class","face").attr("d",m);var w=[{x:70,y:60},{x:120,y:80},{x:140,y:45-o},{x:120,y:45},{x:70,y:30},{x:20,y:45},{x:0,y:45-o},{x:20,y:80}];c.selectAll("path.hair").data([w]).enter().append("path").attr("class","hair").attr("d",m);var x=[{x:70,y:130+p},{x:110-n,y:135-p},{x:70,y:140+p},{x:30+n,y:135-p}];c.selectAll("path.mouth").data([x]).enter().append("path").attr("class","mouth").attr("d",l);var y=[{x:70,y:110-q},{x:70+r,y:110+q},{x:70-r,y:110+q}];c.selectAll("path.nose").data([y]).enter().append("path").attr("class","nose").attr("d",l);var z=[{x:55,y:90-s},{x:55+t,y:90},{x:55,y:90+s},{x:55-t,y:90}],A=[{x:85,y:90-s},{x:85+t,y:90},{x:85,y:90+s},{x:85-t,y:90}];c.selectAll("path.leye").data([z]).enter().append("path").attr("class","leye").attr("d",m),c.selectAll("path.reye").data([A]).enter().append("path").attr("class","reye").attr("d",m),c.append("path").attr("class","lbrow").attr("d","M"+(55-t/1.7-a(u))+","+(87-s+u)+" "+(55+t/1.7-a(u))+","+(87-s-u)),c.append("path").attr("class","rbrow").attr("d","M"+(85-t/1.7+a(u))+","+(87-s-u)+" "+(85+t/1.7+a(u))+","+(87-s+u))}var d=.5,e=0,f=0,g=.5,h=.5,i=.5,j=.5,k=0,l=d3.svg.line().interpolate("cardinal-closed").x(function(a){return a.x}).y(function(a){return a.y}),m=d3.svg.line().interpolate("basis-closed").x(function(a){return a.x}).y(function(a){return a.y});return b.face=function(a){return arguments.length?(d=a,b):d},b.hair=function(a){return arguments.length?(e=a,b):e},b.mouth=function(a){return arguments.length?(f=a,b):f},b.noseh=function(a){return arguments.length?(g=a,b):g},b.nosew=function(a){return arguments.length?(h=a,b):h},b.eyeh=function(a){return arguments.length?(i=a,b):i},b.eyew=function(a){return arguments.length?(j=a,b):j},b.brow=function(a){return arguments.length?(k=a,b):k},b}d3.chernoff=function(){return b(Object)}}(),function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b=b.d3||(b.d3={}),b=b.layout||(b.layout={}),b.cloud=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a){return a.text}function e(){return"serif"}function f(){return"normal"}function g(a){return Math.sqrt(a.value)}function h(){return 30*(~~(6*Math.random())-3)}function i(){return 1}function j(a,b,c,d){if(!b.sprite){var e=a.context,f=a.ratio;e.clearRect(0,0,(u<<5)/f,v/f);var g=0,h=0,i=0,j=c.length;for(--d;++d<j;){b=c[d],e.save(),e.font=b.style+" "+b.weight+" "+~~((b.size+1)/f)+"px "+b.font;var k=e.measureText(b.text+"m").width*f,l=b.size<<1;if(b.rotate){var m=Math.sin(b.rotate*t),n=Math.cos(b.rotate*t),o=k*n,p=k*m,q=l*n,r=l*m;k=Math.max(Math.abs(o+r),Math.abs(o-r))+31>>5<<5,l=~~Math.max(Math.abs(p+q),Math.abs(p-q))}else k=k+31>>5<<5;if(l>i&&(i=l),g+k>=u<<5&&(g=0,h+=i,i=0),h+l>=v)break;e.translate((g+(k>>1))/f,(h+(l>>1))/f),b.rotate&&e.rotate(b.rotate*t),e.fillText(b.text,0,0),b.padding&&(e.lineWidth=2*b.padding,e.strokeText(b.text,0,0)),e.restore(),b.width=k,b.height=l,b.xoff=g,b.yoff=h,b.x1=k>>1,b.y1=l>>1,b.x0=-b.x1,b.y0=-b.y1,b.hasText=!0,g+=k}for(var s=e.getImageData(0,0,(u<<5)/f,v/f).data,w=[];--d>=0;)if(b=c[d],b.hasText){for(var k=b.width,x=k>>5,l=b.y1-b.y0,y=0;l*x>y;y++)w[y]=0;if(g=b.xoff,null==g)return;h=b.yoff;for(var z=0,A=-1,B=0;l>B;B++){for(var y=0;k>y;y++){var C=x*B+(y>>5),D=s[(h+B)*(u<<5)+(g+y)<<2]?1<<31-y%32:0;w[C]|=D,z|=D}z?A=B:(b.y0++,l--,B--,h++)}b.y1=b.y0+A,b.sprite=w.slice(0,(b.y1-b.y0)*x)}}}function k(a,b,c){c>>=5;for(var d,e=a.sprite,f=a.width>>5,g=a.x-(f<<4),h=127&g,i=32-h,j=a.y1-a.y0,k=(a.y+a.y0)*c+(g>>5),l=0;j>l;l++){d=0;for(var m=0;f>=m;m++)if((d<<i|(f>m?(d=e[l*f+m])>>>h:0))&b[k+m])return!0;k+=c}return!1}function l(a,b){var c=a[0],d=a[1];b.x+b.x0<c.x&&(c.x=b.x+b.x0),b.y+b.y0<c.y&&(c.y=b.y+b.y0),b.x+b.x1>d.x&&(d.x=b.x+b.x1),b.y+b.y1>d.y&&(d.y=b.y+b.y1)}function m(a,b){return a.x+a.x1>b[0].x&&a.x+a.x0<b[1].x&&a.y+a.y1>b[0].y&&a.y+a.y0<b[1].y}function n(a){var b=a[0]/a[1];return function(a){return[b*(a*=.1)*Math.cos(a),a*Math.sin(a)]}}function o(a){var b=4,c=b*a[0]/a[1],d=0,e=0;return function(a){var f=0>a?-1:1;switch(Math.sqrt(1+4*f*a)-f&3){case 0:d+=c;break;case 1:e+=b;break;case 2:d-=c;break;default:e-=b}return[d,e]}}function p(a){for(var b=[],c=-1;++c<a;)b[c]=0;return b}function q(){return document.createElement("canvas")}function r(a){return"function"==typeof a?a:function(){return a}}var s=a("d3-dispatch").dispatch,t=Math.PI/180,u=64,v=2048;b.exports=function(){function a(a){a.width=a.height=1;var b=Math.sqrt(a.getContext("2d").getImageData(0,0,1,1).data.length>>2);a.width=(u<<5)/b,a.height=v/b;var c=a.getContext("2d");return c.fillStyle=c.strokeStyle="red",c.textAlign="center",{context:c,ratio:b}}function b(a,b,d){for(var e,f,g,h=([{x:0,y:0},{x:c[0],y:c[1]}],b.x),i=b.y,j=Math.sqrt(c[0]*c[0]+c[1]*c[1]),l=C(c),n=H()<.5?1:-1,o=-n;(e=l(o+=n))&&(f=~~e[0],g=~~e[1],!(Math.min(Math.abs(f),Math.abs(g))>=j));)if(b.x=h+f,b.y=i+g,!(b.x+b.x0<0||b.y+b.y0<0||b.x+b.x1>c[0]||b.y+b.y1>c[1])&&(!d||!k(b,a,c[0]))&&(!d||m(b,d))){for(var p,q=b.sprite,r=b.width>>5,s=c[0]>>5,t=b.x-(r<<4),u=127&t,v=32-u,w=b.y1-b.y0,x=(b.y+b.y0)*s+(t>>5),y=0;w>y;y++){p=0;for(var z=0;r>=z;z++)a[x+z]|=p<<v|(r>z?(p=q[y*r+z])>>>u:0);x+=s}return delete b.sprite,!0}return!1}var c=[256,256],o=d,t=e,x=g,y=f,z=f,A=h,B=i,C=n,D=[],E=1/0,F=s("word","end"),G=null,H=Math.random,I={},J=q;return I.canvas=function(a){return arguments.length?(J=r(a),I):J},I.start=function(){function d(){for(var a=Date.now();Date.now()-a<E&&++i<h&&G;){var d=m[i];d.x=c[0]*(H()+.5)>>1,d.y=c[1]*(H()+.5)>>1,j(e,d,m,i),d.hasText&&b(f,d,g)&&(k.push(d),F.word(d),g?l(g,d):g=[{x:d.x+d.x0,y:d.y+d.y0},{x:d.x+d.x1,y:d.y+d.y1}],d.x-=c[0]>>1,d.y-=c[1]>>1)}i>=h&&(I.stop(),F.end(k,g))}var e=a(J()),f=p((c[0]>>5)*c[1]),g=null,h=D.length,i=-1,k=[],m=D.map(function(a,b){return a.text=o.call(this,a,b),a.font=t.call(this,a,b),a.style=y.call(this,a,b),a.weight=z.call(this,a,b),a.rotate=A.call(this,a,b),a.size=~~x.call(this,a,b),a.padding=B.call(this,a,b),a}).sort(function(a,b){return b.size-a.size});return G&&clearInterval(G),G=setInterval(d,0),d(),I},I.stop=function(){return G&&(clearInterval(G),G=null),I},I.timeInterval=function(a){return arguments.length?(E=null==a?1/0:a,I):E},I.words=function(a){return arguments.length?(D=a,I):D},I.size=function(a){return arguments.length?(c=[+a[0],+a[1]],I):c},I.font=function(a){return arguments.length?(t=r(a),I):t},I.fontStyle=function(a){return arguments.length?(y=r(a),I):y},I.fontWeight=function(a){return arguments.length?(z=r(a),I):z},I.rotate=function(a){return arguments.length?(A=r(a),I):A},I.text=function(a){return arguments.length?(o=r(a),I):o},I.spiral=function(a){return arguments.length?(C=w[a]||a,I):C},I.fontSize=function(a){return arguments.length?(x=r(a),I):x},I.padding=function(a){return arguments.length?(B=r(a),I):B},I.random=function(a){return arguments.length?(H=a,I):H},I.on=function(){var a=F.on.apply(F,arguments);return a===F?I:a},I};var w={archimedean:n,rectangular:o}},{"d3-dispatch":2}],2:[function(b,c,d){!function(b,e){"object"==typeof d&&"undefined"!=typeof c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e(b.dispatch={})}(this,function(a){"use strict";function b(a){function b(a){var b=(a+="").indexOf("."),c=a;if(b>=0?a=a.slice(0,b):c+=".",a&&!g.hasOwnProperty(a))throw new Error("unknown type: "+a);return{type:a,name:c}}function c(a){return function(){for(var b,c,d=g[a],e=-1,f=d.length;++e<f;)(c=(b=d[e]).value)&&c.apply(this,arguments);return i}}var d,e=-1,f=a.length,g={},h={},i=this;for(i.on=function(a,c){if(a=b(a),arguments.length<2)return(c=h[a.name])&&c.value;if(a.type){var d,e=g[a.type],f=h[a.name];f&&(f.value=null,d=e.indexOf(f),g[a.type]=e=e.slice(0,d).concat(e.slice(d+1)),delete h[a.name]),c&&(c={value:c},h[a.name]=c,e.push(c))}else if(null==c)for(var j in g)if(c=h[j+a.name]){c.value=null;var e=g[j],d=e.indexOf(c);g[j]=e.slice(0,d).concat(e.slice(d+1)),delete h[c.name]}return i};++e<f;){if(d=a[e]+"",!d||d in i)throw new Error("illegal or duplicate type: "+d);g[d]=[],i[d]=c(d)}}function c(){return new b(arguments)}c.prototype=b.prototype,a.dispatch=c})},{}]},{},[1])(1)}),function(){function a(a){return function(d,e){d=d3.hsl(d),e=d3.hsl(e);var f=(d.h+120)*c,g=(e.h+120)*c-f,h=d.s,i=e.s-h,j=d.l,k=e.l-j;return isNaN(i)&&(i=0,h=isNaN(h)?e.s:h),isNaN(g)&&(g=0,f=isNaN(f)?e.h:f),function(c){var d=f+g*c,e=Math.pow(j+k*c,a),l=(h+i*c)*e*(1-e),m=Math.cos(d),n=Math.sin(d);return"#"+b(e+l*(-.14861*m+1.78277*n))+b(e+l*(-.29227*m-.90649*n))+b(e+l*(1.97294*m))}}}function b(a){var b=(a=0>=a?0:a>=1?255:255*a|0).toString(16);return 16>a?"0"+b:b}var c=Math.PI/180;d3.scale.cubehelix=function(){return d3.scale.linear().range([d3.hsl(300,.5,0),d3.hsl(-240,.5,1)]).interpolate(d3.interpolateCubehelix)},d3.interpolateCubehelix=a(1),d3.interpolateCubehelix.gamma=a}(),function(){function a(b,c,d){function e(a){var e=b(a),f=d>e,g=d3.extent(b.range()),h=g[0],i=g[1],j=f?d-h:i-d;return 0==j&&(j=i-h),(f?-1:1)*j*(c+1)/(c+j/Math.abs(e-d))+d}return e.distortion=function(a){return arguments.length?(c=+a,e):c},e.focus=function(a){return arguments.length?(d=+a,e):d},e.copy=function(){return a(b.copy(),c,d)},e.nice=b.nice,e.ticks=b.ticks,e.tickFormat=b.tickFormat,d3.rebind(e,b,"domain","range")}d3.fisheye={scale:function(b){return a(b(),3,0)},circular:function(){function a(a){var b=a.x-g[0],f=a.y-g[1],h=Math.sqrt(b*b+f*f);if(!h||h>=e)return{x:a.x,y:a.y,z:1};var i=c*(1-Math.exp(-h*d))/h*.75+.25;return{x:g[0]+b*i,y:g[1]+f*i,z:Math.min(i,10)}}function b(){return c=Math.exp(f),c=c/(c-1)*e,d=f/e,a}var c,d,e=200,f=2,g=[0,0];return a.radius=function(a){return arguments.length?(e=+a,b()):e},a.distortion=function(a){return arguments.length?(f=+a,b()):f},a.focus=function(b){return arguments.length?(g=b,a):g},b()}}}(),function(){d3.force_labels=function(){function a(){b.selection&&b.selection.each(function(a){var b=this.getBBox(),c=b.x+b.width/2,d=b.y+b.height/2;a.anchorPos.x=c,a.anchorPos.y=d,null==a.labelPos.x&&(a.labelPos.x=c,a.labelPos.y=d)})}var b=d3.layout.force();return b.on("tick.labels",a),b.update=function(c){b.selection=c;var d=[],e=[];c[0].forEach(function(a){if(a&&a.__data__){var b=a.__data__;a.labelPos||(a.labelPos={fixed:!1}),a.anchorPos||(a.anchorPos={fixed:!0}),b.labelPos=a.labelPos,b.anchorPos=a.anchorPos,e.push({target:a.anchorPos,source:a.labelPos}),d.push(a.anchorPos),d.push(a.labelPos)}}),b.stop().nodes(d).links(e),a(),b.start()},b}}(),function(){function a(b,c,d){var e,f,g=c.edges,h=g.length,i={type:"MultiPoint",coordinates:c.face},j=c.face.filter(function(a){return 90!==Math.abs(a[1])}),k=d3.geo.bounds({type:"MultiPoint",coordinates:j}),l=!1,m=-1,n=k[1][0]-k[0][0],o=180===n||360===n?[(k[0][0]+k[1][0])/2,(k[0][1]+k[1][1])/2]:d3.geo.centroid(i);if(d)for(;++m<h&&g[m]!==d;);++m;for(var q=0;h>q;++q)f=g[(q+m)%h],Array.isArray(f)?(l||(b.point((e=d3.geo.interpolate(f[0],o)(p))[0],e[1]),l=!0),b.point((e=d3.geo.interpolate(f[1],o)(p))[0],e[1])):(l=!1,f!==d&&a(b,f,c))}function b(a,b){for(var c,d,e=a.length,f=null,g=0;e>g;++g){c=a[g];for(var h=b.length;--h>=0;)if(d=b[h],c[0]===d[0]&&c[1]===d[1]){if(f)return[f,c];f=c}}}function c(a,b){var c=f(a[1],a[0]),d=f(b[1],b[0]),i=h(c,d),j=g(c)/g(d);return e([1,0,a[0][0],0,1,a[0][1]],e([j,0,0,0,j,0],e([Math.cos(i),Math.sin(i),0,-Math.sin(i),Math.cos(i),0],[1,0,-b[0][0],0,1,-b[0][1]])))}function d(a){var b=1/(a[0]*a[4]-a[1]*a[3]);return[b*a[4],-b*a[1],b*(a[1]*a[5]-a[2]*a[4]),-b*a[3],b*a[0],b*(a[2]*a[3]-a[0]*a[5])]}function e(a,b){return[a[0]*b[0]+a[1]*b[3],a[0]*b[1]+a[1]*b[4],a[0]*b[2]+a[1]*b[5]+a[2],a[3]*b[0]+a[4]*b[3],a[3]*b[1]+a[4]*b[4],a[3]*b[2]+a[4]*b[5]+a[5]]}function f(a,b){return[a[0]-b[0],a[1]-b[1]]}function g(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function h(a,b){return Math.atan2(a[0]*b[1]-a[1]*b[0],a[0]*b[0]+a[1]*b[1])}function i(a,b){for(var c=0,d=a.length,e=0;d>c;++c)e+=a[c]*b[c];return e}function j(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function k(a){return[Math.atan2(a[1],a[0])*s,Math.asin(Math.max(-1,Math.min(1,a[2])))*s]}function l(a){var b=a[0]*r,c=a[1]*r,d=Math.cos(c);return[d*Math.cos(b),d*Math.sin(b),Math.sin(c)]}function m(a,b){return a&&b&&a[0]===b[0]&&a[1]===b[1]}function n(a){for(var b=a.length,c=[],d=a[b-1],e=0;b>e;++e)c.push([d,d=a[e]]);return c}function o(a){return a.project.invert||a.children&&a.children.some(o)}var p=1e-6,q=Math.PI,r=q/180,s=180/q;d3.geo.polyhedron=function(f,g,h){function i(a,d){if(a.edges=n(a.face),d)if(d.face){var f=a.shared=b(a.face,d.face),g=c(f.map(d.project),f.map(a.project));a.transform=d.transform?e(d.transform,g):g;for(var h=d.edges,j=0,k=h.length;k>j;++j)m(f[0],h[j][1])&&m(f[1],h[j][0])&&(h[j]=a),m(f[0],h[j][0])&&m(f[1],h[j][1])&&(h[j]=a);for(var h=a.edges,j=0,k=h.length;k>j;++j)m(f[0],h[j][0])&&m(f[1],h[j][1])&&(h[j]=d),m(f[0],h[j][1])&&m(f[1],h[j][0])&&(h[j]=d)}else a.transform=d.transform;return a.children&&a.children.forEach(function(b){i(b,a)}),a}function j(a,b){var c,d=g(a,b),e=d.project([a*s,b*s]);return(c=d.transform)?[c[0]*e[0]+c[1]*e[1]+c[2],-(c[3]*e[0]+c[4]*e[1]+c[5])]:(e[1]=-e[1],e)}function k(a,b){var c=a.project.invert,e=a.transform,f=b;if(e&&(e=d(e),f=[e[0]*f[0]+e[1]*f[1]+e[2],e[3]*f[0]+e[4]*f[1]+e[5]]),c&&a===l(g=c(f)))return g;for(var g,h=a.children,i=0,j=h&&h.length;j>i;++i)if(g=k(h[i],b))return g}function l(a){return g(a[0]*r,a[1]*r)}h=null==h?-q/6:h,i(f,{transform:[Math.cos(h),Math.sin(h),0,-Math.sin(h),Math.cos(h),0]}),o(f)&&(j.invert=function(a,b){var c=k(f,[a,-b]);return c&&(c[0]*=r,c[1]*=r,c)});var p=d3.geo.projection(j),t=p.stream;return p.stream=function(b){var c=p.rotate(),d=t(b),e=(p.rotate([0,0]),t(b));return p.rotate(c),d.sphere=function(){e.polygonStart(),e.lineStart(),a(e,f),e.lineEnd(),e.polygonEnd()},d},p},d3.geo.polyhedron.butterfly=function(a){a=a||function(a){var b=d3.geo.centroid({type:"MultiPoint",coordinates:a});return d3.geo.gnomonic().scale(1).translate([0,0]).rotate([-b[0],-b[1]])};var b=d3.geo.polyhedron.octahedron.map(function(b){return{face:b,project:a(b)}});return[-1,0,0,1,0,1,4,5].forEach(function(a,c){var d=b[a];d&&(d.children||(d.children=[])).push(b[c])}),d3.geo.polyhedron(b[0],function(a,c){return b[-q/2>a?0>c?6:4:0>a?0>c?2:0:q/2>a?0>c?3:1:0>c?7:5]})},d3.geo.polyhedron.waterman=function(a){function b(a,b){var c=Math.cos(b),d=[c*Math.cos(a),c*Math.sin(a),Math.sin(b)],f=-q/2>a?0>b?6:4:0>a?0>b?2:0:q/2>a?0>b?3:1:0>b?7:5,h=e[f];return g[i(h[0],d)<0?8+3*f:i(h[1],d)<0?8+3*f+1:i(h[2],d)<0?8+3*f+2:f]}a=a||function(a){var b=6===a.length?d3.geo.centroid({type:"MultiPoint",coordinates:a}):a[0];return d3.geo.gnomonic().scale(1).translate([0,0]).rotate([-b[0],-b[1]])};var c=d3.geo.polyhedron.octahedron,d=c.map(function(a){for(var b,c=a.map(l),d=c.length,e=c[d-1],f=[],g=0;d>g;++g)b=c[g],f.push(k([.9486832980505138*e[0]+.31622776601683794*b[0],.9486832980505138*e[1]+.31622776601683794*b[1],.9486832980505138*e[2]+.31622776601683794*b[2]]),k([.9486832980505138*b[0]+.31622776601683794*e[0],.9486832980505138*b[1]+.31622776601683794*e[1],.9486832980505138*b[2]+.31622776601683794*e[2]])),e=b;return f}),e=[],f=[-1,0,0,1,0,1,4,5];d.forEach(function(a,b){for(var g=c[b],h=g.length,i=e[b]=[],k=0;h>k;++k)d.push([g[k],a[(2*k+2)%(2*h)],a[(2*k+1)%(2*h)]]),f.push(b),i.push(j(l(a[(2*k+2)%(2*h)]),l(a[(2*k+1)%(2*h)])))});var g=d.map(function(b){return{project:a(b),face:b}});return f.forEach(function(a,b){var c=g[a];c&&(c.children||(c.children=[])).push(g[b])}),d3.geo.polyhedron(g[0],b).center([0,45])};var t=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]];d3.geo.polyhedron.octahedron=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(a){return a.map(function(a){return t[a]})});var u=Math.atan(Math.SQRT1_2)*s,v=[[0,u],[90,u],[180,u],[-90,u],[0,-u],[90,-u],[180,-u],[-90,-u]];d3.geo.polyhedron.cube=[[0,3,2,1],[0,1,5,4],[1,2,6,5],[2,3,7,6],[3,0,4,7],[4,5,6,7]].map(function(a){return a.map(function(a){return v[a]})})}(),d3.geo.tile=function(){function a(){var a=Math.max(Math.log(c)/Math.LN2-8,0),f=Math.round(a+e),g=Math.pow(2,a-f+8),h=[(d[0]-c/2)/g,(d[1]-c/2)/g],i=[],j=d3.range(Math.max(0,Math.floor(-h[0])),Math.max(0,Math.ceil(b[0]/g-h[0]))),k=d3.range(Math.max(0,Math.floor(-h[1])),Math.max(0,Math.ceil(b[1]/g-h[1])));return k.forEach(function(a){j.forEach(function(b){i.push([b,a,f])})}),i.translate=h,i.scale=g,i}var b=[960,500],c=256,d=[b[0]/2,b[1]/2],e=0;return a.size=function(c){return arguments.length?(b=c,a):b},a.scale=function(b){return arguments.length?(c=b,a):c},a.translate=function(b){return arguments.length?(d=b,a):d},a.zoomDelta=function(b){return arguments.length?(e=+b,a):e},a},function(){function a(a){return d3.merge(h.map(function(b){var d=c(b[0],b[1]),e=c(b[0],b[2]),f=[];f.push([b[0],d(1/a),e(1/a)]);for(var g=1;a>g;++g){for(var h=c(d(g/a),e(g/a)),i=c(d((g+1)/a),e((g+1)/a)),j=0;g>=j;++j)f.push([h(j/g),i(j/(g+1)),i((j+1)/(g+1))]);for(var j=0;g>j;++j)f.push([h(j/g),i((j+1)/(g+1)),h((j+1)/g)])}return f}))}function b(b){function c(a,b){var c;(a[0]<b[0]||a[0]==b[0]&&(a[1]<b[1]||a[1]==b[1]&&a[2]<b[2]))&&(c=a,a=b,b=c),e[a.map(d)+" "+b.map(d)]=[a,b]}function d(a){return d3.round(a,4)}var e={};return a(b).forEach(function(a){c(a[0],a[1]),c(a[1],a[2]),c(a[2],a[0])}),d3.values(e)}function c(a,b){var c=a[0],d=a[1],e=a[2],f=b[0]-c,g=b[1]-d,h=b[2]-e;return function(a){return[c+a*f,d+a*g,e+a*h]}}function d(a){var b=a[0],c=a[1],d=a[2];return[Math.atan2(c,b)*f,Math.acos(d/Math.sqrt(b*b+c*c+d*d))*f-90]}var e=1.618033988749895,f=180/Math.PI,g=[[1,e,0],[-1,e,0],[1,-e,0],[-1,-e,0],[0,1,e],[0,-1,e],[0,1,-e],[0,-1,-e],[e,0,1],[-e,0,1],[e,0,-1],[-e,0,-1]],h=[[0,1,4],[1,9,4],[4,9,5],[5,9,3],[2,3,7],[3,2,5],[7,10,2],[0,8,10],[0,4,8],[8,2,10],[8,4,5],[8,5,2],[1,0,6],[11,1,6],[3,9,11],[6,10,7],[3,11,7],[11,6,7],[6,0,10],[9,1,11]].map(function(a){return a.map(function(a){return g[a]})});d3.geodesic={multipolygon:function(b){return{type:"MultiPolygon",coordinates:a(~~b).map(function(a){return a=a.map(d),a.push(a[0]),a=[a]})}},polygons:function(a){return d3.geodesic.multipolygon(~~a).coordinates.map(function(a){return{type:"Polygon",coordinates:a}})},multilinestring:function(a){return{type:"MultiLineString",coordinates:b(~~a).map(function(a){return a.map(d)})}}}}(),function(){function a(a){for(var b=0,c=0;;){if(a(b,c))return[b,c];0===b?(b=c+1,c=0):(b-=1,c+=1)}}d3.geom.contour=function(d,e){var f=e||a(d),g=[],h=f[0],i=f[1],j=0,k=0,l=NaN,m=NaN,n=0;do n=0,d(h-1,i-1)&&(n+=1),d(h,i-1)&&(n+=2),d(h-1,i)&&(n+=4),d(h,i)&&(n+=8),6===n?(j=-1===m?-1:1,k=0):9===n?(j=0,k=1===l?-1:1):(j=b[n],k=c[n]),j!=l&&k!=m&&(g.push([h,i]),l=j,m=k),h+=j,i+=k;while(f[0]!=h||f[1]!=i);return g};var b=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],c=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN]}(),function(a){a.graph=function(b){var b=b?b:{},c=[],d=[];return b.description=function(){return"d3.graph with "+c.length+" nodes and "+d.length+" links"},b.nodes=function(a){return arguments.length?(c=a,this):c},b.links=function(a){return arguments.length?(d=a,this):d},b.matrix=function(b){return arguments.length?(d=a.graph.matrixToList(b),this):a.graph.listToMatrix(d)},b},a.graph.matrix=function(a){var a=a?a:[],b=function(b,c){return a[b][c]};return b.description=function(){return"A "+a.length+" by "+a.length+" adjacency matrix"},b.data=b.matrix=function(b){return arguments.length?(a=b,this):a},b.set=b.addEdge=function(b,c,d){return a[b][c]=d?d:1,this},b.remove=b.removeEdge=function(b,c){return a[b][c]=0,this},b.has=b.hasEdge=function(b,c){return!!a[b][c]},b.outE=b.outEdges=function(b){for(var c=[],d=a.length,e=-1;++e<d;)a[b][e]&&c.push(e);return c},b.inE=b.inEdges=function(b){for(var c=[],d=a.length,e=-1;++e<d;)a[e][b]&&c.push(e);return c},b},a.graph.listToMatrix=function(b){for(var c=[],d=b.length,e=a.max(b,function(b){return a.max([b.source,b.target])}),f=-1;++f<=e;){c[f]=[];for(var g=-1;++g<=e;)c[f][g]=0}for(f=-1;++f<d;)c[b[f].source][b[f].target]=b[f].value;return c},a.graph.matrixToList=function(a){for(var b=[],c=a.length,d=-1;++d<c;)for(var e=-1;++e<c;)b.push({source:d,target:e,value:a[d][e]});return b}}(d3),function(){d3.hexbin=function(){function d(a){var b={};return a.forEach(function(a,c){var e=l.call(d,a,c)/h,f=Math.round(e),i=k.call(d,a,c)/g-(1&f?.5:0),j=Math.round(i),m=e-f;if(3*Math.abs(m)>1){var n=i-j,o=j+(j>i?-1:1)/2,p=f+(f>e?-1:1),q=i-o,r=e-p;n*n+m*m>q*q+r*r&&(j=o+(1&f?1:-1)/2,f=p)}var s=j+"-"+f,t=b[s];t?t.push(a):(t=b[s]=[a],t.i=j,t.j=f,t.x=(j+(1&f?.5:0))*g,t.y=f*h)}),d3.values(b)}function e(b){var c=0,d=0;return a.map(function(a){var e=Math.sin(a)*b,f=-Math.cos(a)*b,g=e-c,h=f-d;return c=e,d=f,[g,h]})}var f,g,h,i=1,j=1,k=b,l=c;return d.x=function(a){return arguments.length?(k=a,d):k},d.y=function(a){return arguments.length?(l=a,d):l},d.hexagon=function(a){return arguments.length<1&&(a=f),"m"+e(a).join("l")+"z"},d.centers=function(){for(var a=[],b=0,c=!1,d=0;j+f>b;b+=h,c=!c,++d)for(var e=c?g/2:0,k=0;i+g/2>e;e+=g,++k){var l=[e,b];l.i=k,l.j=d,a.push(l)}return a},d.mesh=function(){var a=e(f).slice(0,4).join("l");return d.centers().map(function(b){return"M"+b+"m"+a}).join("")},d.size=function(a){return arguments.length?(i=+a[0],j=+a[1],d):[i,j]},d.radius=function(a){return arguments.length?(f=+a,g=2*f*Math.sin(Math.PI/3),h=1.5*f,d):f},d.radius(1)};var a=d3.range(0,2*Math.PI,Math.PI/3),b=function(a){return a[0]},c=function(a){return a[1]}}(),d3.hive={},d3.hive.link=function(){function a(a,e){var f,g=b(c,this,a,e),h=b(d,this,a,e);h.a<g.a&&(f=h,h=g,g=f),h.a-g.a>Math.PI&&(g.a+=2*Math.PI);var i=g.a+(h.a-g.a)/3,j=h.a-(h.a-g.a)/3;return g.r0-g.r1||h.r0-h.r1?"M"+Math.cos(g.a)*g.r0+","+Math.sin(g.a)*g.r0+"L"+Math.cos(g.a)*g.r1+","+Math.sin(g.a)*g.r1+"C"+Math.cos(i)*g.r1+","+Math.sin(i)*g.r1+" "+Math.cos(j)*h.r1+","+Math.sin(j)*h.r1+" "+Math.cos(h.a)*h.r1+","+Math.sin(h.a)*h.r1+"L"+Math.cos(h.a)*h.r0+","+Math.sin(h.a)*h.r0+"C"+Math.cos(j)*h.r0+","+Math.sin(j)*h.r0+" "+Math.cos(i)*g.r0+","+Math.sin(i)*g.r0+" "+Math.cos(g.a)*g.r0+","+Math.sin(g.a)*g.r0:"M"+Math.cos(g.a)*g.r0+","+Math.sin(g.a)*g.r0+"C"+Math.cos(i)*g.r1+","+Math.sin(i)*g.r1+" "+Math.cos(j)*h.r1+","+Math.sin(j)*h.r1+" "+Math.cos(h.a)*h.r1+","+Math.sin(h.a)*h.r1}function b(a,b,c,d){var i=a.call(b,c,d),j=+("function"==typeof e?e.call(b,i,d):e)+h,k=+("function"==typeof f?f.call(b,i,d):f),l=f===g?k:+("function"==typeof g?g.call(b,i,d):g);return{r0:k,r1:l,a:j}}var c=function(a){return a.source},d=function(a){return a.target},e=function(a){return a.angle},f=function(a){return a.radius},g=f,h=-Math.PI/2;return a.source=function(b){return arguments.length?(c=b,a):c},a.target=function(b){return arguments.length?(d=b,a):d},a.angle=function(b){return arguments.length?(e=b,a):e},a.radius=function(b){return arguments.length?(f=g=b,a):f},a.startRadius=function(b){return arguments.length?(f=b,a):f},a.endRadius=function(b){return arguments.length?(g=b,a):g},a},function(){function a(a){return a[0]}function b(a){return a[1]}function c(a,b,c){return"offset"==c?function(c){return"translate(0,"+(c+(0>c)-a)*b+")"}:function(c){return(0>c?"scale(1,-1)":"")+"translate(0,"+(c-a)*b+")"}}d3.horizon=function(){function e(a){a.each(function(a){var b,e,o,p,q=d3.select(this),r=1/0,s=-(1/0),t=-(1/0),u=a.map(function(a,b){var c=j.call(this,a,b),d=k.call(this,a,b);return r>c&&(r=c),c>s&&(s=c),-d>t&&(t=-d),d>t&&(t=d),[c,d]}),v=d3.scale.linear().domain([r,s]).range([0,l]),w=d3.scale.linear().domain([0,t]).range([0,m*g]),x=c(g,m,h);this.__chart__?(b=this.__chart__.x,e=this.__chart__.y,o=this.__chart__.t,p=this.__chart__.id):(b=v.copy(),e=w.copy(),o=x,p=++d);var y=q.selectAll("defs").data([null]);y.enter().append("defs").append("clipPath").attr("id","d3_horizon_clip"+p).append("rect").attr("width",l).attr("height",m),d3.transition(y.select("rect")).attr("width",l).attr("height",m),q.selectAll("g").data([null]).enter().append("g").attr("clip-path","url(#d3_horizon_clip"+p+")");var z=q.select("g").selectAll("path").data(d3.range(-1,-g-1,-1).concat(d3.range(1,g+1)),Number);f&&i.defined(function(b,c){return f.call(this,a[c],c)});var A=i.x(function(a){return b(a[0])}).y0(m*g).y1(function(a){return m*g-e(a[1])})(u),B=i.x(function(a){return v(a[0])}).y1(function(a){return m*g-w(a[1])})(u);z.enter().append("path").style("fill",n).attr("transform",o).attr("d",A),d3.transition(z).style("fill",n).attr("transform",x).attr("d",B),d3.transition(z.exit()).attr("transform",x).attr("d",B).remove(),this.__chart__={x:v,y:w,t:x,id:p}})}var f,g=1,h="offset",i=d3.svg.area(),j=a,k=b,l=960,m=40,n=d3.scale.linear().domain([-1,0,1]).range(["#d62728","#fff","#1f77b4"]);return e.bands=function(a){return arguments.length?(g=+a,n.domain([-g,0,g]),e):g},e.mode=function(a){return arguments.length?(h=a+"",e):h},e.colors=function(a){return arguments.length?(n.range(a),e):n.range()},e.x=function(a){return arguments.length?(j=a,e):j},e.y=function(a){return arguments.length?(k=a,e):k},e.width=function(a){return arguments.length?(l=+a,e):l;
},e.height=function(a){return arguments.length?(m=+a,e):m},e.defined=function(a){return arguments.length?(f=a,e):f},d3.rebind(e,i,"interpolate","tension")};var d=0}();var vows=require("vows"),assert=require("assert");global.d3=require("d3"),require("./interpolate-zoom");var suite=vows.describe("d3.interpolateZoom");suite.addBatch({interpolateZoom:{topic:function(){return d3.interpolateZoom},identity:function(a){var b=a([1,1,1],[1,1,1]);assert.deepEqual(b(0),[1,1,1]),assert.deepEqual(b(.5),[1,1,1]),assert.deepEqual(b(1),[1,1,1])},"ux0 almost equal to ux1":function(a){var b=a([6317.937500000001,9242.5,2],[6317.9375,9242.5,5]);assert.deepEqual(b(0),[6317.937500000001,9242.5,2]),assert.deepEqual(b(.5),[6317.9375,9242.5,3.162277660168379]),assert.deepEqual(b(1),[6317.9375,9242.5,5])}}}),suite["export"](module),function(){function a(a){return(Math.exp(a)+Math.exp(-a))/2}function b(a){return(Math.exp(a)-Math.exp(-a))/2}function c(c){return b(c)/a(c)}var d=Math.SQRT2,e=2,f=4;d3.interpolateZoom=function(g,h){function i(f){var g=f*y;if(x){var h=a(v),i=l/(e*s)*(h*c(d*g+v)-b(v));return[j+i*p,k+i*q,l*h/a(d*g+v)]}return[j+f*p,k+f*q,l*Math.exp(d*g)]}var j=g[0],k=g[1],l=g[2],m=h[0],n=h[1],o=h[2],p=m-j,q=n-k,r=p*p+q*q,s=Math.sqrt(r),t=(o*o-l*l+f*r)/(2*l*e*s),u=(o*o-l*l-f*r)/(2*o*e*s),v=Math.log(Math.sqrt(t*t+1)-t),w=Math.log(Math.sqrt(u*u+1)-u),x=w-v,y=(x||Math.log(o/l))/d;return i.duration=1e3*y,i}}(),d3.jsonp=function(a,b){function c(){for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",b="",c=-1;++c<15;)b+=a.charAt(Math.floor(52*Math.random()));return b}function d(a){var d=a.match(/callback=d3.jsonp.(\w+)/),e=d?d[1]:c();return d3.jsonp[e]=function(a){b(a),delete d3.jsonp[e],f.remove()},"d3.jsonp."+e}var e=d(a),f=d3.select("head").append("script").attr("type","text/javascript").attr("src",a.replace(/(\{|%7B)callback(\}|%7D)/,e))},d3.keybinding=function(a){function b(a,b){for(var c in a.event)if(b[c]!=a.event[c])return!1;return!a.capture==(b.eventPhase!==Event.CAPTURING_PHASE)}function c(){for(var a=0;a<f.length;a++){var c=f[a];b(c,d3.event)&&c.callback()}}function d(){var a=d3.select(d3.event.target).node().tagName;"INPUT"!=a&&"SELECT"!=a&&"TEXTAREA"!=a&&c()}function e(b){return b=b||d3.select(document),b.on("keydown.capture"+a,c,!0),b.on("keydown.bubble"+a,d,!1),e}var f=[];return e.off=function(b){return b=b||d3.select(document),b.on("keydown.capture"+a,null),b.on("keydown.bubble"+a,null),e},e.on=function(a,b,c){var d={event:{keyCode:0,shiftKey:!1,ctrlKey:!1,altKey:!1,metaKey:!1},capture:c,callback:b};a=a.toLowerCase().match(/(?:(?:[^+])+|\+\+|^\+$)/g);for(var g=0;g<a.length;g++)"++"===a[g]&&(a[g]="+"),a[g]in d3.keybinding.modifierCodes?d.event[d3.keybinding.modifierProperties[d3.keybinding.modifierCodes[a[g]]]]=!0:a[g]in d3.keybinding.keyCodes&&(d.event.keyCode=d3.keybinding.keyCodes[a[g]]);return f.push(d),e},e},function(){d3.keybinding.modifierCodes={"⇧":16,shift:16,"⌃":17,ctrl:17,"⌥":18,alt:18,option:18,"⌘":91,meta:91,cmd:91,"super":91,win:91},d3.keybinding.modifierProperties={16:"shiftKey",17:"ctrlKey",18:"altKey",91:"metaKey"},d3.keybinding.keyCodes={"⌫":8,backspace:8,"⇥":9,"⇆":9,tab:9,"↩":13,"return":13,enter:13,"⌅":13,pause:19,"pause-break":19,"⇪":20,caps:20,"caps-lock":20,"⎋":27,escape:27,esc:27,space:32,"↖":33,pgup:33,"page-up":33,"↘":34,pgdown:34,"page-down":34,"⇟":35,end:35,"⇞":36,home:36,ins:45,insert:45,"⌦":46,del:46,"delete":46,"←":37,left:37,"arrow-left":37,"↑":38,up:38,"arrow-up":38,"→":39,right:39,"arrow-right":39,"↓":40,down:40,"arrow-down":40,"*":106,star:106,asterisk:106,multiply:106,"+":107,plus:107,"-":109,subtract:109,";":186,semicolon:186,"=":187,equals:187,",":188,comma:188,".":190,period:190,"full-stop":190,"/":191,slash:191,"forward-slash":191,"`":192,tick:192,"back-quote":192,"[":219,"open-bracket":219,"\\":220,"back-slash":220,"]":221,"close-bracket":221,"'":222,quote:222,apostrophe:222};for(var a=95,b=0;++a<106;)d3.keybinding.keyCodes["num-"+b]=a,++b;for(a=47,b=0;++a<58;)d3.keybinding.keyCodes[b]=a,++b;for(a=111,b=1;++a<136;)d3.keybinding.keyCodes["f"+b]=a,++b;for(a=64;++a<91;)d3.keybinding.keyCodes[String.fromCharCode(a).toLowerCase()]=a}(),function(){d3.longscroll=function(){function a(a){function f(f){a.each(function(){this.scrollTop=f;var a=d3.select(this),g=1+Math.ceil(this.clientHeight/e),h=Math.max(0,Math.min(c-g,d)),i=h+g;a.select(".before").style("height",h*e+"px"),a.select(".after").style("height",(c-i)*e+"px");var j=a.select(".current").selectAll("div.row").data(d3.range(h,Math.min(i,c)),String);j.enter().append("div").attr("class","row"),j.exit().remove(),j.order().call(b)})}a.selectAll("div.before").data([0]).enter().append("div").attr("class","before");var g=a.selectAll("div.current").data([0]);g.enter().append("div").attr("class","current"),a.selectAll("div.after").data([0]).enter().append("div").attr("class","after"),a.on("scroll.longscroll",function(){d=Math.floor(this.scrollTop/e),f(this.scrollTop)}),f(0),a.each(function(){var a=d3.select(this);a.property("scrollTop",+a.select(".before").style("height").replace("px",""))})}var b=null,c=0,d=0,e=20;return a.render=function(c){return arguments.length?(b=c,a):b},a.rowHeight=function(b){return arguments.length?(e=+b,a):e},a.position=function(b){return arguments.length?(d=+b,a):d},a.size=function(b){return arguments.length?(c=+b,a):c},a}}(),function(){function a(a,b){var c=b.length-1;return b=b.slice().sort(d3.ascending),d3.range(a).map(function(d){return b[~~(d*c/a)]})}function b(a){return a.x}function c(a){return a.y}d3.qq=function(){function d(b){b.each(function(b,c){var d,m,n=d3.select(this),o=a(j,k.call(this,b,c)),p=a(j,l.call(this,b,c)),q=h&&h.call(this,b,c)||[d3.min(o),d3.max(o)],r=h&&h.call(this,b,c)||[d3.min(p),d3.max(p)],s=d3.scale.linear().domain(q).range([0,e]),t=d3.scale.linear().domain(r).range([f,0]);this.__chart__?(d=this.__chart__.x,m=this.__chart__.y):(d=d3.scale.linear().domain([0,1/0]).range(s.range()),m=d3.scale.linear().domain([0,1/0]).range(t.range())),this.__chart__={x:s,y:t};var u=n.selectAll("line.diagonal").data([null]);u.enter().append("svg:line").attr("class","diagonal").attr("x1",s(r[0])).attr("y1",t(q[0])).attr("x2",s(r[1])).attr("y2",t(q[1])),u.transition().duration(g).attr("x1",s(r[0])).attr("y1",t(q[0])).attr("x2",s(r[1])).attr("y2",t(q[1]));var v=n.selectAll("circle").data(d3.range(j).map(function(a){return{x:o[a],y:p[a]}}));v.enter().append("svg:circle").attr("class","quantile").attr("r",4.5).attr("cx",function(a){return d(a.x)}).attr("cy",function(a){return m(a.y)}).style("opacity",1e-6).transition().duration(g).attr("cx",function(a){return s(a.x)}).attr("cy",function(a){return t(a.y)}).style("opacity",1),v.transition().duration(g).attr("cx",function(a){return s(a.x)}).attr("cy",function(a){return t(a.y)}).style("opacity",1),v.exit().transition().duration(g).attr("cx",function(a){return s(a.x)}).attr("cy",function(a){return t(a.y)}).style("opacity",1e-6).remove();var w=i||s.tickFormat(4),x=i||t.tickFormat(4),y=function(a){return"translate("+s(a)+","+f+")"},z=function(a){return"translate(0,"+t(a)+")"},A=n.selectAll("g.x.tick").data(s.ticks(4),function(a){return this.textContent||w(a)}),B=A.enter().append("svg:g").attr("class","x tick").attr("transform",function(a){return"translate("+d(a)+","+f+")"}).style("opacity",1e-6);B.append("svg:line").attr("y1",0).attr("y2",-6),B.append("svg:text").attr("text-anchor","middle").attr("dy","1em").text(w),B.transition().duration(g).attr("transform",y).style("opacity",1),A.transition().duration(g).attr("transform",y).style("opacity",1),A.exit().transition().duration(g).attr("transform",y).style("opacity",1e-6).remove();var C=n.selectAll("g.y.tick").data(t.ticks(4),function(a){return this.textContent||x(a)}),D=C.enter().append("svg:g").attr("class","y tick").attr("transform",function(a){return"translate(0,"+m(a)+")"}).style("opacity",1e-6);D.append("svg:line").attr("x1",0).attr("x2",6),D.append("svg:text").attr("text-anchor","end").attr("dx","-.5em").attr("dy",".3em").text(x),D.transition().duration(g).attr("transform",z).style("opacity",1),C.transition().duration(g).attr("transform",z).style("opacity",1),C.exit().transition().duration(g).attr("transform",z).style("opacity",1e-6).remove()})}var e=1,f=1,g=0,h=null,i=null,j=100,k=b,l=c;return d.width=function(a){return arguments.length?(e=a,d):e},d.height=function(a){return arguments.length?(f=a,d):f},d.duration=function(a){return arguments.length?(g=a,d):g},d.domain=function(a){return arguments.length?(h=null==a?a:d3.functor(a),d):h},d.count=function(a){return arguments.length?(j=a,d):j},d.x=function(a){return arguments.length?(k=a,d):k},d.y=function(a){return arguments.length?(l=a,d):l},d.tickFormat=function(a){return arguments.length?(i=a,d):i},d}}(),d3.rollup=function(){function a(a,b){function c(a){return h[a]+","+q[a]}for(var d=l.call(this,a,b),e=m.call(this,a,b),f=d.length,g=e.length,b=-1,h=[],q=[],r=0,s={},t={};++b<f;){(a=d[b]).index=b,h[b]=j.call(this,a,b),q[b]=k.call(this,a,b);var u=c(b),v=s[u];v||(v=s[u]={index:r++,x:h[b],y:q[b],nodes:[]}),v.nodes.push(a)}for(b=-1;++b<g;){var w=n.call(this,a=e[b],b),x=o.call(this,a,b),y=p.call(this,a,b),z=s[c("number"==typeof x?x:x.index)],A=s[c("number"==typeof y?y:y.index)],B=!i&&z.index>A.index?A.index+","+z.index:z.index+","+A.index,C=t[B];C||(C=t[B]={source:z,target:A,value:0,links:[]}),C.links.push(e[b]),C.value+=w}return{nodes:d3.values(s),links:d3.values(t)}}function b(a){return a.x}function c(a){return a.y}function d(a){return a.nodes}function e(a){return a.links}function f(a){return 1}function g(a){return a.source}function h(a){return a.target}var i=!0,j=b,k=c,l=d,m=e,n=f,o=g,p=h;return a.x=function(b){return arguments.length?(j=b,a):j},a.y=function(b){return arguments.length?(k=b,a):k},a.nodes=function(b){return arguments.length?(l=b,a):l},a.links=function(b){return arguments.length?(m=b,a):m},a.linkSource=function(b){return arguments.length?(o=b,a):o},a.linkTarget=function(b){return arguments.length?(p=b,a):p},a.linkValue=function(b){return arguments.length?(n=b,a):n},a.directed=function(b){return arguments.length?(i=b,a):i},a},d3.sankey=function(){function a(){n.forEach(function(a){a.sourceLinks=[],a.targetLinks=[]}),o.forEach(function(a){var b=a.source,c=a.target;"number"==typeof b&&(b=a.source=n[a.source]),"number"==typeof c&&(c=a.target=n[a.target]),b.sourceLinks.push(a),c.targetLinks.push(a)})}function b(){n.forEach(function(a){a.value=Math.max(d3.sum(a.sourceLinks,i),d3.sum(a.targetLinks,i))})}function c(){for(var a,b=n,c=0;b.length;)a=[],b.forEach(function(b){b.x=c,b.dx=k,b.sourceLinks.forEach(function(b){a.indexOf(b.target)<0&&a.push(b.target)})}),b=a,++c;d(c),e((m[0]-k)/(c-1))}function d(a){n.forEach(function(b){b.sourceLinks.length||(b.x=a-1)})}function e(a){n.forEach(function(b){b.x*=a})}function f(a){function b(){var a=d3.min(g,function(a){return(m[1]-(a.length-1)*l)/d3.sum(a,i)});g.forEach(function(b){b.forEach(function(b,c){b.y=c,b.dy=b.value*a})}),o.forEach(function(b){b.dy=b.value*a})}function c(a){function b(a){return h(a.source)*a.value}g.forEach(function(c,d){c.forEach(function(c){if(c.targetLinks.length){var d=d3.sum(c.targetLinks,b)/d3.sum(c.targetLinks,i);c.y+=(d-h(c))*a}})})}function d(a){function b(a){return h(a.target)*a.value}g.slice().reverse().forEach(function(c){c.forEach(function(c){if(c.sourceLinks.length){var d=d3.sum(c.sourceLinks,b)/d3.sum(c.sourceLinks,i);c.y+=(d-h(c))*a}})})}function e(){g.forEach(function(a){var b,c,d,e=0,g=a.length;for(a.sort(f),d=0;g>d;++d)b=a[d],c=e-b.y,c>0&&(b.y+=c),e=b.y+b.dy+l;if(c=e-l-m[1],c>0)for(e=b.y-=c,d=g-2;d>=0;--d)b=a[d],c=b.y+b.dy+l-e,c>0&&(b.y-=c),e=b.y})}function f(a,b){return a.y-b.y}var g=d3.nest().key(function(a){return a.x}).sortKeys(d3.ascending).entries(n).map(function(a){return a.values});b(),e();for(var j=1;a>0;--a)d(j*=.99),e(),c(j),e()}function g(){function a(a,b){return a.source.y-b.source.y}function b(a,b){return a.target.y-b.target.y}n.forEach(function(c){c.sourceLinks.sort(b),c.targetLinks.sort(a)}),n.forEach(function(a){var b=0,c=0;a.sourceLinks.forEach(function(a){a.sy=b,b+=a.dy}),a.targetLinks.forEach(function(a){a.ty=c,c+=a.dy})})}function h(a){return a.y+a.dy/2}function i(a){return a.value}var j={},k=24,l=8,m=[1,1],n=[],o=[];return j.nodeWidth=function(a){return arguments.length?(k=+a,j):k},j.nodePadding=function(a){return arguments.length?(l=+a,j):l},j.nodes=function(a){return arguments.length?(n=a,j):n},j.links=function(a){return arguments.length?(o=a,j):o},j.size=function(a){return arguments.length?(m=a,j):m},j.layout=function(d){return a(),b(),c(),f(d),g(),j},j.relayout=function(){return g(),j},j.link=function(){function a(a){var c=a.source.x+a.source.dx,d=a.target.x,e=d3.interpolateNumber(c,d),f=e(b),g=e(1-b),h=a.source.y+a.sy+a.dy/2,i=a.target.y+a.ty+a.dy/2;return"M"+c+","+h+"C"+f+","+h+" "+g+","+i+" "+d+","+i}var b=.5;return a.curvature=function(c){return arguments.length?(b=+c,a):b},a},j},function(){function a(a,b,d){for(var e,f,g,h=-1,i=2*Math.PI/b,j=0,k=[];++h<b;)e=a.m*(h*i-Math.PI)/4,e=Math.pow(Math.abs(Math.pow(Math.abs(Math.cos(e)/a.a),a.n2)+Math.pow(Math.abs(Math.sin(e)/a.b),a.n3)),-1/a.n1),e>j&&(j=e),k.push(e);for(j=d*Math.SQRT1_2/j,h=-1;++h<b;)f=(e=k[h]*j)*Math.cos(h*i),g=e*Math.sin(h*i),k[h]=[Math.abs(f)<1e-6?0:f,Math.abs(g)<1e-6?0:g];return c(k)+"Z"}var b=d3.svg.symbol(),c=d3.svg.line();d3.superformula=function(){function c(b,c){var i,j=d[e.call(this,b,c)];for(i in h)j[i]=h[i].call(this,b,c);return a(j,g.call(this,b,c),Math.sqrt(f.call(this,b,c)))}var e=b.type(),f=b.size(),g=f,h={};return c.type=function(a){return arguments.length?(e=d3.functor(a),c):e},c.param=function(a,b){return arguments.length<2?h[a]:(h[a]=d3.functor(b),c)},c.size=function(a){return arguments.length?(f=d3.functor(a),c):f},c.segments=function(a){return arguments.length?(g=d3.functor(a),c):g},c};var d={asterisk:{m:12,n1:.3,n2:0,n3:10,a:1,b:1},bean:{m:2,n1:1,n2:4,n3:8,a:1,b:1},butterfly:{m:3,n1:1,n2:6,n3:2,a:.6,b:1},circle:{m:4,n1:2,n2:2,n3:2,a:1,b:1},clover:{m:6,n1:.3,n2:0,n3:10,a:1,b:1},cloverFour:{m:8,n1:10,n2:-1,n3:-8,a:1,b:1},cross:{m:8,n1:1.3,n2:.01,n3:8,a:1,b:1},diamond:{m:4,n1:1,n2:1,n3:1,a:1,b:1},drop:{m:1,n1:.5,n2:.5,n3:.5,a:1,b:1},ellipse:{m:4,n1:2,n2:2,n3:2,a:9,b:6},gear:{m:19,n1:100,n2:50,n3:50,a:1,b:1},heart:{m:1,n1:.8,n2:1,n3:-8,a:1,b:.18},heptagon:{m:7,n1:1e3,n2:400,n3:400,a:1,b:1},hexagon:{m:6,n1:1e3,n2:400,n3:400,a:1,b:1},malteseCross:{m:8,n1:.9,n2:.1,n3:100,a:1,b:1},pentagon:{m:5,n1:1e3,n2:600,n3:600,a:1,b:1},rectangle:{m:4,n1:100,n2:100,n3:100,a:2,b:1},roundedStar:{m:5,n1:2,n2:7,n3:7,a:1,b:1},square:{m:4,n1:100,n2:100,n3:100,a:1,b:1},star:{m:5,n1:30,n2:100,n3:100,a:1,b:1},triangle:{m:3,n1:100,n2:200,n3:200,a:1,b:1}};d3.superformulaTypes=d3.keys(d)}(),global.d3=require("d3"),require("./urlencode");var vows=require("vows"),assert=require("assert"),suite=vows.describe("d3.urlencode");suite.addBatch({urlencode:{topic:function(){return d3.urlencode},"returns an instanceof d3.urlencode":function(a){assert.instanceOf(a(),d3.urlencode)},"returns an array":function(a){assert.isArray(a(),d3.urlencode),assert.deepEqual(a("foo",2).and("bar"),["foo=2","bar"])},"can be empty":function(a){assert.strictEqual(a()+"","")},"can be modified via array methods, albeit unsafely":function(a){var b=a("foo",1).and("bar",2).and("baz",3);b.splice(1,1),b.push("unsafe=true"),b.sort(),assert.strictEqual(b+"","baz=3&foo=1&unsafe=true")},"has the type application/x-www-form-urlencoded;charset=utf-8":function(a){assert.strictEqual(a.type,"application/x-www-form-urlencoded;charset=utf-8")},"encodes the name and value per the HTML 4.01 specification":function(a){assert.strictEqual(a("foo","bar")+"","foo=bar"),assert.strictEqual(a("f o","b r")+"","f+o=b+r"),assert.strictEqual(a("foo","bär")+"","foo=b%C3%A4r")},"coerces the name and value to strings":function(a){var b={toString:function(){return"foo"}},c=new String("bar");assert.strictEqual(a(b,c)+"","foo=bar")},and:{"modifies the urlencode in-place":function(a){var b=a("foo","bar");assert.strictEqual(b.and("baz"),b),assert.strictEqual(b+"","foo=bar&baz")},"supports multiple values with the same name":function(a){assert.strictEqual(a("foo",1).and("foo",2)+"","foo=1&foo=2")}},"ignores the value if null or undefined":function(a){assert.strictEqual(a("foo")+"","foo"),assert.strictEqual(a("foo",null)+"","foo"),assert.strictEqual(a("foo",void 0)+"","foo")},"does not ignore the value if the empty string":function(a){assert.strictEqual(a("foo","")+"","foo=")},"does not ignore the value if falsey":function(a){assert.strictEqual(a("foo",0).and("bar",!1)+"","foo=0&bar=false")}}}),suite["export"](module),function(){function a(a){return encodeURIComponent(a).replace(/%20/g,"+")}d3.urlencode=function(a,d){var e=[];return b(e,c),arguments.length?e.and(a,d):e},d3.urlencode.type="application/x-www-form-urlencoded;charset=utf-8";var b=[].__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]},c=d3.urlencode.prototype=[];c.and=function(b,c){return b=a(b),this.push(null==c?b:b+"="+a(c)),this},c.toString=function(){return this.join("&")}}();